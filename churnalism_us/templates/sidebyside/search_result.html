{% extends "base.html" %}
{% load jsonify %}
{% block head %}
<link rel="stylesheet" href="{{ STATIC_URL }}styles/search_result.css">
{% endblock %}
{% block title %}Search Results{% endblock title%}
{% block body %}
<div id="main-content">
    <h2>Possible Churns</h2>
    <span class="share">Share this url:<form action="{% url sidebyside-shared uuid=results.uuid %}" > <input type="text" value="{%url sidebyside-uuid-search uuid=results.uuid %}" /><input type="submit" value="share" /></form></span>
    <div id="source-box">
        <div id="left-rail">
            {{ results.documents.rows|length }} results
            <ul id="results-listing">
            {% for row in results.documents.rows %}
			<li id="match-title-{{ row.doctype }}-{{ row.docid }}">
				<div class="match-coverage-pct">
					{{ row.coverage.1|floatformat:0 }}% Pasted
				</div>
				<div class="match-coverage-chars">
					{{ row.coverage.0 }} Characters overlap
				</div>
				<span class="match-title-text">{{ row.title }}</span>
			</li>
            {% endfor %}
            </ul>
        </div>
        <div id="match-box">
			<header class="match-url">Originally from: <a class="match-url"></a></header>
			<header id="match-title"></header>
            {% for row in results.documents.rows %}
            <div class="match-text" id="match-text-{{ row.doctype }}-{{ row.docid }}">
				{% firstof row.text '' %}
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock body %}

{% block js %}
    {{ block.super }}

	<script type="text/javascript" src="{{ STATIC_URL }}scripts/jquery.scrollintoview.min.js"></script>
	<script type="text/javascript" src="{{ STATIC_URL }}scripts/highlight.js"></script>
	<script type="text/javascript">
		$(document).ready(function(){
			window.search_results = {{ results|jsonify|safe }};
		});
	</script>
    <script type="text/javascript" src="{{ STATIC_URL }}scripts/sidebyside_search_result.js" %}></script>
{% endblock js %}
